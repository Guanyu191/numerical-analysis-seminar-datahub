# 12-3-绝对稳定性 (Absolute stability)

这是一份数值计算学习笔记，参考了 Tobin A. Driscoll and Richard J. Braun 的教材 [*Fundamentals of Numerical Computation* (2023)](https://tobydriscoll.net/fnc-julia/home.html).

> 这份笔记主要是翻译了原文内容，并删改或重新表述部分内容，希望能进一步减少初学者的学习障碍.

**#1 用谱来读 CFL**

CFL 判据给出了收敛的必要条件. 它暗示：对流方程可能只需要 $O(h)$ 级别的时间步长就能稳定推进，但仅靠 CFL 还不能确认这一点. 更细的结论需要我们采用半离散 (线法) 的视角.

考虑区间 $[0,1]$ 上的对流方程，并施加周期端条件. 设我们用 **12-1-交通流** 里出现的中心差分一阶导数矩阵 $\mathbf{D}_x$ 来离散空间导数，则得到半离散系统

$$
\mathbf{u}'=-c\mathbf{D}_x\mathbf{u}.
$$

为了使用某个 IVP 求解器，我们需要像 **11-3-绝对稳定性** 那样，把求解器的稳定区域与矩阵 $-c\mathbf{D}_x$ 的特征值进行比较. 可以验证：当我们用 $m$ 个点离散 $[0,1)$ (即 $h=1/m$) 时，其特征值为

$$
\lambda_k=-icm\sin\Bigl(\frac{2\pi k}{m}\Bigr),\qquad k=0,\dots,m-1.
$$

这些特征值有两个显著特点：

1. 它们是纯虚数，这与 "幅度守恒" 的直觉一致.
2. 它们离原点最远也只到 $O(m)=O(h^{-1})$ 的距离.

这两点提示了：我们可以通过稳定区域来分析不同时间推进方法在对流问题上的表现.

**#2 对流方程与稳定区域的匹配**

> **Demo:** Eigenvalues for pure advection
> For $c=1$, the eigenvalues of $-c\mathbf{D}_x$ are purely imaginary.
>
> ```Python
> import numpy as np
> import matplotlib.pyplot as plt
>
> def eigvals_advection(m, c=1.0):
>     k = np.arange(m)
>     return -1j * c * m * np.sin(2.0 * np.pi * k / m)
>
> lam = eigvals_advection(200, c=1.0)
> plt.scatter(lam.real, lam.imag, s=12)
> plt.axhline(0.0, color="k", lw=0.8, alpha=0.3)
> plt.axvline(0.0, color="k", lw=0.8, alpha=0.3)
> plt.gca().set_aspect("equal", adjustable="box")
> plt.title("Eigenvalues for pure advection")
> plt.xlabel("Re λ")
> plt.ylabel("Im λ")
> plt.grid(True, alpha=0.3)
> plt.show()
> ```

如果取时间步长 $\tau=0.1$，并用 $\zeta=\tau\lambda$ 把特征值缩放到稳定区域所在的 $\zeta$ 平面，我们会发现：

- 对 Euler 方法，稳定区域是 $|\zeta+1|\le 1$，它除了原点之外不包含虚轴上的点，因此无论 $\tau>0$ 取多小，对流问题的 $\zeta$ 都不可能落入该稳定区域. 因此，任何稳定区域完全不包含虚轴的方法，都不适合对流问题.
- 对 backward Euler，稳定区域覆盖整个左半平面，因此它对纯对流在绝对稳定性意义下对任意 $\tau$ 都稳定.

> **Note:** 对纯对流，backward Euler 虽然绝对稳定，但会把幅度指数衰减到 0，这相当于引入强烈的数值耗散. 因此稳定性只是必要条件之一，我们还需要关注这种耗散是否会掩盖真正的传播现象.

> **Demo:** Euler vs backward Euler stability regions for advection
> ```Python
> tau = 0.1
> zeta = tau * lam
>
> theta = np.linspace(0.0, 2.0 * np.pi, 600)
> euler_bd = -1.0 + np.exp(1j * theta)  # |ζ+1|=1
> be_bd = 1.0 + np.exp(1j * theta)      # |ζ-1|=1
>
> plt.plot(euler_bd.real, euler_bd.imag, label="Euler: |ζ+1|=1")
> plt.scatter(zeta.real, zeta.imag, s=12, label="ζ = τλ")
> plt.gca().set_aspect("equal", adjustable="box")
> plt.title("Euler for advection (no τ>0 can work)")
> plt.xlabel("Re ζ")
> plt.ylabel("Im ζ")
> plt.grid(True, alpha=0.3)
> plt.legend()
> plt.show()
>
> plt.plot(be_bd.real, be_bd.imag, label="Backward Euler: |ζ-1|=1")
> plt.scatter(zeta.real, zeta.imag, s=12, label="ζ = τλ")
> plt.gca().set_aspect("equal", adjustable="box")
> plt.title("Backward Euler for advection (A-stable)")
> plt.xlabel("Re ζ")
> plt.ylabel("Im ζ")
> plt.grid(True, alpha=0.3)
> plt.legend()
> plt.show()
> ```

很多守恒型 PDE 的半离散系统都会出现虚轴附近的特征值，因此 Euler 与一些其他方法会在任意步长下失败. 相比之下，扩散问题的特征值通常是负实数，因此与更多时间推进方法兼容，但可能因为刚性而带来严苛的步长限制.

特征值大约位于 $\pm ic/h$ 的尺度也印证了 CFL 的提示. 例如，对 RK4 来说，它的稳定区域与虚轴大约在 $\pm 2.8i$ 处相交，因此绝对稳定性要求

$$
\frac{\tau c}{h}\le 2.8,
$$

也就是 $\tau=O(h)$.

> **Note:** 对经典 RK4，数值计算表明它与虚轴的交点在 $\pm 2\\sqrt{2}\,i\\approx \pm 2.828i$.

**#3 对流-扩散方程的谱**

交通流方程把非线性对流与扩散项组合在一起. 具有相同结构的最简单线性模型是对流-扩散方程

$$
u_t+cu_x=\epsilon u_{xx}.
$$

参数 $\epsilon$ 控制两种机制的相对强弱；相应地，半离散系统的特征值会在 "纯对流的纯虚特征值" 与 "纯扩散的负实特征值" 之间变化.

> **Demo:** Eigenvalues for advection-diffusion (qualitative)
> We compute eigenvalues of the semidiscrete operator $-c\mathbf{D}_x + \epsilon \mathbf{D}_{xx}$ under periodic end conditions.
>
> ```Python
> import scipy.sparse as sp
>
> def diffper(n, xspan):
>     a, b = float(xspan[0]), float(xspan[1])
>     h = (b - a) / n
>     x = a + h * np.arange(n)
>
>     dp = np.full(n - 1, 0.5 / h)
>     dm = np.full(n - 1, -0.5 / h)
>     Dx = sp.diags([dm, dp], offsets=[-1, 1], shape=(n, n), format="lil")
>     Dx[0, n - 1] = -1.0 / (2.0 * h)
>     Dx[n - 1, 0] = 1.0 / (2.0 * h)
>
>     d0 = np.full(n, -2.0 / h**2)
>     dp2 = np.full(n - 1, 1.0 / h**2)
>     Dxx = sp.diags([dp2, d0, dp2], offsets=[-1, 0, 1], shape=(n, n), format="lil")
>     Dxx[0, n - 1] = 1.0 / h**2
>     Dxx[n - 1, 0] = 1.0 / h**2
>
>     return x, Dx.tocsr(), Dxx.tocsr()
>
> m = 200
> _, Dx, Dxx = diffper(m, (0.0, 1.0))
> Dx = Dx.toarray()
> Dxx = Dxx.toarray()
> c = 1.0
>
> for eps in [0.001, 0.01, 0.05]:
>     A = -c * Dx + eps * Dxx
>     lam = np.linalg.eigvals(A)
>     plt.scatter(lam.real, lam.imag, s=10, alpha=0.6, label=f"eps={eps}")
>
> plt.title("Eigenvalues for advection-diffusion")
> plt.xlabel("Re λ")
> plt.ylabel("Im λ")
> plt.grid(True, alpha=0.3)
> plt.legend()
> plt.show()
> ```
>
> As $\epsilon$ increases, the eigenvalues move closer to the negative real axis.

在非线性问题中，特征值来自沿着精确解轨道的线性化 Jacobian (见 **11-4-刚性**).

**#4 边界条件对谱的影响**

边界条件会显著改变半离散系统的特征值. 例如，**12-2-迎风格式与稳定性** 中的入流条件 Demo 考虑了在 $[0,1]$ 上求解对流方程，并施加齐次入流条件. 在这种情形下，把边界节点从半离散未知量中剔除，相当于把全向量 $\mathbf{u}$ 通过一个嵌入/投影矩阵转成内部向量 $\mathbf{v}$.

更具体地说，设 $\mathbf{E}$ 是把最后一行删掉的单位矩阵，则

$$
\mathbf{v}=\mathbf{E}\mathbf{u},\qquad
\mathbf{u}=\mathbf{E}^T\mathbf{v},
$$

并且边界值被固定 (例如 $u_m=0$). 内部节点上的 ODE 为

$$
\frac{d\mathbf{v}}{dt}
=
\mathbf{E}(\mathbf{D}_x\mathbf{u})
=
\mathbf{E}\mathbf{D}_x\mathbf{E}^T\mathbf{v}.
$$

因此，决定半离散特征值的矩阵应取

$$
\mathbf{A}=\mathbf{E}\mathbf{D}_x\mathbf{E}^T,
$$

更直接地说：我们可以把 $\mathbf{D}_x$ 的最后一行与最后一列删掉来得到 $\mathbf{A}$.

> **Demo:** Eigenvalues with zero inflow boundary condition
> Deleting the last row and column places all eigenvalues into the left half-plane.
>
> ```Python
> import numpy as np
> import matplotlib.pyplot as plt
>
> def diffcheb(n, xspan):
>     k = np.arange(n + 1)
>     x = -np.cos(np.pi * k / n)
>
>     c = np.ones(n + 1)
>     c[0] = 2.0
>     c[-1] = 2.0
>     c = c * ((-1) ** k)
>
>     dX = x[:, None] - x[None, :]
>     D = (c[:, None] / c[None, :]) / (dX + np.eye(n + 1))
>     D = D - np.diag(D.sum(axis=1))
>
>     a, b = float(xspan[0]), float(xspan[1])
>     x = a + (b - a) * (x + 1.0) / 2.0
>     Dx = 2.0 * D / (b - a)
>     return x, Dx
>
> _, Dx = diffcheb(40, (0.0, 1.0))
> A = Dx[:-1, :-1]   # delete last row and column
> lam = np.linalg.eigvals(A)
>
> plt.scatter(lam.real, lam.imag, s=16)
> plt.axhline(0.0, color="k", lw=0.8, alpha=0.3)
> plt.axvline(0.0, color="k", lw=0.8, alpha=0.3)
> plt.gca().set_aspect("equal", adjustable="box")
> plt.title("Eigenvalues of advection with zero inflow")
> plt.xlabel("Re λ")
> plt.ylabel("Im λ")
> plt.grid(True, alpha=0.3)
> plt.show()
>
> print("max Re(λ) =", lam.real.max())
> ```
>
> With all eigenvalues having negative real parts, solutions decay exponentially to zero as $t\\to\\infty$, matching the fact that everything eventually flows out of the domain.
