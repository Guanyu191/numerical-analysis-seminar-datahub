# 6-8-多步法的零稳定性 (Zero-stability of multistep methods)

这是一份数值计算学习笔记，参考了 Tobin A. Driscoll and Richard J. Braun 的教材 [*Fundamentals of Numerical Computation* (2023)](https://tobydriscoll.net/fnc-julia/home.html).

> 这份笔记主要是翻译了原文内容，并删改或重新表述部分内容，希望能进一步减少初学者的学习障碍.

**#1 多步法的新麻烦：零稳定性**

对于 Runge-Kutta 这类单步法，我们有一个结论保证：方法收敛，并且全局误差与局部截断误差同阶 (见 **6-2-Euler-方法** 里关于收敛阶的讨论). 但多步法会引入一个新的麻烦：即使一个多步法的局部截断误差阶数很高，它仍然可能不收敛.

**#2 一个三阶但会爆炸的两步法: LIAF**

下面这个两步法 LIAF 可以直接检验出是三阶精度：

$$
u_{i+1}=-4u_i+5u_{i-1}+h(4f_i+2f_{i-1}).
$$

我们把它用于一个极其简单的 IVP 来观察现象.

> **Demo:** A catastrophically unstable multistep method
> We apply the two-step LIAF method
> $$
> u_{i+1}=-4u_i+5u_{i-1}+h(4f_i+2f_{i-1})
> $$
> to the IVP $u'=u$, $u(0)=1$ on $0\le t\le 1$ (exact solution $u(t)=e^t$), and measure the error at $t=1$.
>
> ```Python
> import numpy as np
> import matplotlib.pyplot as plt
>
> def liaf(f, tspan, u0, n, u1):
>     a, b = float(tspan[0]), float(tspan[1])
>     h = (b - a) / n
>     t = a + h * np.arange(n + 1)
>     u = np.empty(n + 1, dtype=float)
>     u[0] = float(u0)
>     u[1] = float(u1)
>
>     f0 = float(f(t[0], u[0]))
>     f1 = float(f(t[1], u[1]))
>     for i in range(1, n):
>         u[i + 1] = -4.0 * u[i] + 5.0 * u[i - 1] + h * (4.0 * f1 + 2.0 * f0)
>         f0, f1 = f1, float(f(t[i + 1], u[i + 1]))
>     return t, u
>
> f = lambda t, u: u
> exact = lambda t: np.exp(t)
>
> ns = [5, 10, 20, 40, 60]
> rows = []
> for n in ns:
>     h = 1.0 / n
>     t, u = liaf(f, (0.0, 1.0), u0=1.0, n=n, u1=exact(h))
>     err = abs(u[-1] - exact(1.0))
>     rows.append((n, h, err))
>
> for n, h, err in rows:
>     print(f"n={n:>3d}, h={h:>10.7f}, error={err:.6g}")
>
> # A clue: plot the last attempt.
> n = ns[-1]
> h = 1.0 / n
> t, u = liaf(f, (0.0, 1.0), u0=1.0, n=n, u1=exact(h))
> plt.plot(t, np.abs(u), marker="o", ms=3, lw=1.0)
> plt.yscale("log")
> plt.xlabel("t")
> plt.ylabel("|u(t)|")
> plt.title("LIAF solution")  # the numerical one, not e^t
> plt.grid(True, which="both", alpha=0.3)
> plt.show()
> ```
>
> The error starts out promisingly, but then it explodes:
>
> $$
> \begin{array}{c c c}
> \hline
> n & h & \text{error at } t=1\\
> \hline
> 5 & 0.2 & 0.0160452\\
> 10 & 0.1 & 2.84548\\
> 20 & 0.05 & 1.6225\times 10^{6}\\
> 40 & 0.025 & 9.3442\times 10^{18}\\
> 60 & 0.0166667 & 1.74013\times 10^{32}\\
> \hline
> \end{array}
> $$
>
> The plot of the last attempt shows that the computed solution grows exponentially in time.

**#3 为什么会爆炸：特征多项式与伪解**

上面 Demo 的指数增长来源并不难找. 回忆：我们可以用前移算子 $Z$ 把多步法写成

$$
\rho(Z)u_{i-1}=h\sigma(Z)f_{i-1},
\qquad (Zu)_i=u_{i+1}.
$$

对 LIAF，这个形式变为

$$
(Z^2+4Z-5)u_{i-1}=h(4Z+2)f_{i-1}.
$$

如果把 $h\sigma(Z)f_{i-1}$ 视为可以忽略的扰动，那么数值解大致满足齐次差分方程

$$
(Z^2+4Z-5)u_{i-1}=0.
$$

上面最后一次尝试的图像强烈暗示：当 $h$ 很小时，$|u_i|$ 近似呈 $c\alpha^i$ 的指数增长，其中 $\alpha>1$. 因此我们尝试令

$$
u_i=c z^i
$$

对所有 $i$ 成立，并检验它能否成为齐次差分方程的精确解. 这个假设的好处是，对所有 $i$ 都有

$$
Zu_i=u_{i+1}=z u_i.
$$

于是齐次方程化为特征方程

$$
z^2+4z-5=0.
$$

该方程的两个根分别是 $z=1$ 与 $z=-5$. 因此当 $h\to 0$ 时，这个两步法除了 "想要的" 模式之外，还允许一个近似的增长模式 $\approx |(-5)^i|$. 一旦存在截断误差或舍入误差，这个增长模式就可能被激发并迅速主导数值解.

**#4 零稳定性与根条件**

LIAF 缺少的关键性质如下.

> **Definition:** Zero-stability of a multistep IVP method
> A multistep method is **zero-stable** if, as $h\to 0$, every numerical solution produced by the method remains bounded throughout $a\le t_i\le b$.

如果没有零稳定性，任何截断误差或舍入误差都会被指数级放大，最终压倒我们期望的收敛行为.

下面的定理给出何时能期待零稳定性.

> **Theorem:** Root condition
> A linear multistep method is **zero-stable** if and only if every root $r$ of the generating polynomial $\rho(z)$ satisfies $|r|\le 1$, and any root $r$ with $|r|=1$ is simple.

> **Example:** Adams methods are zero-stable
> A $k$-step Adams method has $\rho(z)=z^k-z^{k-1}=z^{k-1}(z-1)$. Hence $1$ is a simple root and $0$ is a root of multiplicity $k-1$. So the Adams methods are all stable.

> **Example:** A consistent method that is not zero-stable
> The method
> $$
> u_{i+1}=2u_i-u_{i-1}+h(f_i-f_{i-1})
> $$
> is first-order accurate. But $\rho(z)=(z-1)^2$, which has a double root at $z=1$, so it is not zero-stable.

**#5 Dahlquist 等价定理与稳定性屏障**

多步法的一个好消息是：对于一致 (consistent) 的多步法而言，"零稳定性缺失" 是唯一会让它失败的机制.

> **Theorem:** Dahlquist equivalence
> A linear multistep method converges as $h\to 0$ if and only if it is consistent and zero-stable.

这个等价定理在数值分析史上非常重要. 更精确的结论还可以表明：如果一个方法一致且零稳定，那么它的误差行为与单步法的情形类似，即全局误差与局部截断误差同阶 (对一大类问题都成立).

你可能注意到 Adams 与 BD 公式只使用了过去 $k$ 步信息中的大约一半，也就是说，它们有许多可能的系数被设置为 0. 例如，一个 $k$ 步 AB 方法只使用 $f$ 值，且阶数为 $k$. 如果我们也使用 $u$ 值，理论上可以把阶数做得更高 (LIAF 的 $k=2$ 就是这种做法). 但类似的尝试会像 LIAF 一样，被不稳定性扼杀.

> **Theorem:** First Dahlquist stability barrier
> The order of accuracy $p$ of a stable $k$-step linear multistep method satisfies
> $$
> p \le
> \begin{cases}
> k+2, & \text{if } k \text{ is even},\\
> k+1, & \text{if } k \text{ is odd},\\
> k, & \text{if the method is explicit}.
> \end{cases}
> $$

上面的屏障告诉我们：精度并不是唯一重要的特征，试图只在 "阶数" 上做极致优化，往往会直接导致失败. 相同主题会在 **11-3-绝对稳定性** 里再次出现.

> **Note:** 对线性多步法，零稳定性只由 $\rho(z)$ 的根决定. 一旦存在 $|r|>1$ 的根，或者在 $|r|=1$ 上出现重根，误差就会被差分方程的增长模式放大，从而破坏收敛.
