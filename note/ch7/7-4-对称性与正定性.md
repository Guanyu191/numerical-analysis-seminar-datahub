# 7-4-对称性与正定性 (Symmetry and definiteness)

这是一份数值计算学习笔记，参考了 Tobin A. Driscoll and Richard J. Braun 的教材 [*Fundamentals of Numerical Computation* (2023)](https://tobydriscoll.net/fnc-julia/home.html).

> 这份笔记主要是翻译了原文内容，并删改或重新表述部分内容，希望能进一步减少初学者的学习障碍.

**#1 对称性带来的简化**

正如我们在 **2-9-利用矩阵结构** 里看到的，对称性会把 LU 分解简化为对称形式 $\mathbf{A}=\mathbf{L}\mathbf{D}\mathbf{L}^{T}$. 对特征值分解与奇异值分解也会出现类似的重要特化.

本节仍然以复矩阵为背景，因此我们关注的对称性是

$$
\mathbf{A}^{*}=\mathbf{A},
$$

即 $\mathbf{A}$ 是 Hermitian 矩阵. 不过在复数情形下，我们也常把这种性质宽泛地称为 "对称性". 本节的所有结论都可以直接特化到实矩阵情形.

**#2 Normality 与谱分解**

设 $\mathbf{A}^{*}=\mathbf{A}$，并且 $\mathbf{A}=\mathbf{U}\mathbf{S}\mathbf{V}^{*}$ 是一个 SVD. 因为 $\mathbf{S}$ 是实的且方阵，我们有

$$
\mathbf{A}^{*}=\mathbf{V}\mathbf{S}\mathbf{U}^{*}.
$$

这会让人想要得出 $\mathbf{U}=\mathbf{V}$. 这并不总是严格成立，但对 Hermitian 矩阵有一个非常接近的更强结论.

> **Theorem:** Spectral decomposition
> If $\mathbf{A}=\mathbf{A}^{*}$, then $\mathbf{A}$ has a diagonalization $\mathbf{A}=\mathbf{V}\mathbf{D}\mathbf{V}^{-1}$ in which $\mathbf{V}$ is unitary and $\mathbf{D}$ is diagonal and real.

换句话说: Hermitian 矩阵有实特征值与一组完备的正交归一特征向量，也就是它是 normal 的. 因为 Hermitian 矩阵是 normal 的，结合 **7-2-特征值分解** 里的 Bauer-Fike 定理，我们还能得到: Hermitian 矩阵的特征值条件数保证为 1.

反过来，前面的 Theorem 关于 Spectral decomposition 的逆命题也成立：每个具有实特征值的 normal 矩阵都是 Hermitian. 这在 **7-2-特征值分解** 的 Demo "Bauer-Fike in action" 里也用数值检查展示过：对 Hermitian 矩阵，特征向量矩阵的条件数 $\kappa(\mathbf{V})$ 接近 1.

对于 Hermitian 矩阵，EVD

$$
\mathbf{A}=\mathbf{V}\mathbf{D}\mathbf{V}^{-1}=\mathbf{V}\mathbf{D}\mathbf{V}^{*}
$$

几乎就是一个 SVD.

> **Theorem:** From unitary diagonalization to an SVD
> If $\mathbf{A}^{*}=\mathbf{A}$ and $\mathbf{A}=\mathbf{V}\mathbf{D}\mathbf{V}^{-1}$ is a unitary diagonalization, then
> $$
> \mathbf{A}=(\mathbf{V}\mathbf{T})\cdot |\mathbf{D}|\cdot \mathbf{V}^{*}
> $$
> is an SVD, where $|\mathbf{D}|$ is the elementwise absolute value and $\mathbf{T}$ is diagonal with $|T_{ii}|=1$ for all $i$.

**#3 Rayleigh 商**

回忆：对矩阵 $\mathbf{A}$ 与相容向量 $\mathbf{x}$，二次型 $\mathbf{x}^{*}\mathbf{A}\mathbf{x}$ 是一个标量.

> **Definition:** Rayleigh quotient
> Given hermitian $\mathbf{A}$ and nonzero vector $\mathbf{x}$, the **Rayleigh quotient** is the function
> $$
> R_{\mathbf{A}}(\mathbf{x})=\frac{\mathbf{x}^{*}\mathbf{A}\mathbf{x}}{\mathbf{x}^{*}\mathbf{x}}.
> $$

如果 $\mathbf{v}$ 是一个特征向量且 $\mathbf{A}\mathbf{v}=\lambda\mathbf{v}$，那么很容易算出 $R_{\mathbf{A}}(\mathbf{v})=\lambda$. 也就是说，Rayleigh 商会把特征向量映射到它对应的特征值.

当 $\mathbf{A}^{*}=\mathbf{A}$ 时，Rayleigh 商还有一个重要性质：如果 $\mathbf{v}$ 是特征向量，那么 $\nabla R_{\mathbf{A}}(\mathbf{v})=\mathbf{0}$. 用多元 Taylor 展开可得

$$
R_{\mathbf{A}}(\mathbf{v}+\epsilon\mathbf{z})
=
R_{\mathbf{A}}(\mathbf{v})+0+O(\epsilon^2)
=
\lambda+O(\epsilon^2),
\qquad \epsilon\to 0.
$$

结论是：如果我们对特征向量有一个不错的近似，那么把它带入 Rayleigh 商会得到一个更高精度的特征值近似.

> **Demo:** Rayleigh quotient error is second order
> We construct a symmetric matrix with a known eigenpair and observe that a perturbation of size $\delta$ in the eigenvector leads to an $O(\delta^2)$ error in the Rayleigh quotient.
>
> ```Python
> import numpy as np
>
> rng = np.random.default_rng(0)
> n = 20
> lam = np.arange(1, n + 1, dtype=float)
> D = np.diag(lam)
> V, _ = np.linalg.qr(rng.standard_normal((n, n)))  # random orthogonal V
> A = V @ D @ V.T
>
> def R(x):
>     x = x.reshape(-1, 1)
>     return float((x.T @ A @ x) / (x.T @ x))
>
> k = 6  # 0-based index, so eigenvalue is k+1
> vk = V[:, [k]]
> print("R(v_k) =", R(vk), " target =", k + 1)
>
> deltas = 1.0 / (10.0 ** np.arange(1, 6))
> rows = []
> for delta in deltas:
>     e = rng.standard_normal((n, 1))
>     e = delta * e / np.linalg.norm(e, 2)
>     x = vk + e
>     rows.append((delta, delta**2, R(x) - (k + 1)))
>
> for delta, d2, diff in rows:
>     print(f"delta={delta:.1e}, delta^2={d2:.1e}, R(x)-lambda={diff:.6g}")
> ```

**#4 正定、半正定、非定**

在实矩阵情形，我们称一个对称矩阵 $\mathbf{A}$ 为对称正定 (SPD)，如果对所有非零向量 $\mathbf{x}$ 都有 $\mathbf{x}^{T}\mathbf{A}\mathbf{x}>0$. 在复矩阵情形，对应概念是 Hermitian 正定 (HPD)：$\mathbf{A}^{*}=\mathbf{A}$ 且对所有非零复向量 $\mathbf{x}$ 都有 $\mathbf{x}^{*}\mathbf{A}\mathbf{x}>0$.

把这个性质与 Rayleigh 商结合，可得到一个非常关键的等价刻画.

> **Theorem:** HPD and eigenvalues
> If $\mathbf{A}^{*}=\mathbf{A}$, then the following statements are equivalent.
> 1. $\mathbf{A}$ is HPD.
> 2. The eigenvalues of $\mathbf{A}$ are positive numbers.

根据该定理：对 HPD 矩阵，如果我们把特征值按非负顺序排列，那么 EVD $\mathbf{A}=\mathbf{V}\mathbf{D}\mathbf{V}^{*}$ 也满足 SVD 的所有要求.

Hermitian 矩阵若全部特征值为负，则称为 negative definite. 若特征值有正有负，则称为 indefinite. 若存在 0 特征值且其余特征值同号，则称为 positive semidefinite 或 negative semidefinite.

> **Note:** "定性" 本质上描述的是二次型 $\mathbf{x}^{*}\mathbf{A}\mathbf{x}$ 的符号结构，而对 Hermitian 矩阵，它又与特征值的符号结构完全一致.
