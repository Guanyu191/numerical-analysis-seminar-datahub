# 10-1-两点边值问题 (Two-point BVP)

这是一份数值计算学习笔记，参考了 Tobin A. Driscoll and Richard J. Braun 的教材 [*Fundamentals of Numerical Computation* (2023)](https://tobydriscoll.net/fnc-julia/home.html).

> 这份笔记主要是翻译了原文内容，并删改或重新表述部分内容，希望能进一步减少初学者的学习障碍.

**#1 从初值问题到边值问题**

第 6 章的初值问题 (**initial-value problem**, IVP) 通常由两部分刻画：一个常微分方程，以及在自变量某个取值处给定的解状态.

在边值问题 (**boundary-value problem**, BVP) 中，我们不会在任何一个点把状态完全给定. 相反，我们会在自变量的多个取值处给出部分信息. 这一节只关注最常见的一类两点边值问题.

> **Definition:** Two-point boundary-value problem (TPBVP)
> $$
> \begin{aligned}
> u''(x) &= \phi(x,u,u'), && a\le x \le b,\\
> g_1\bigl(u(a),u'(a)\bigr) &= 0,\\
> g_2\bigl(u(b),u'(b)\bigr) &= 0.
> \end{aligned}
> $$

当 $\phi$、$g_1$、$g_2$ 对解 $u(x)$ 的依赖是线性的时，这个 TPBVP 被称为线性的. 更具体地说，这意味着存在系数函数 $p(x)$、$q(x)$、$r(x)$ 使得

$$
\phi(x,u,u') = p(x)u' + q(x)u + r(x),
$$

并且 $g_1$、$g_2$ 分别在其各自的每个自变量上都是线性的.

在很多问题里，$x$ 的定义域不会被单独写出来，而是由 $g_1$ 与 $g_2$ 的定义所隐含. $g_1$ 与 $g_2$ 被称为边界条件 (**boundary conditions**).

如果对同一个二阶常微分方程写 IVP，那么通常会在同一点给定 $u(a)$ 与 $u'(a)$ 的数值. 这看起来只是一个小改动，但 IVP 与 BVP 的性质很不同. 直觉上，这种差别有点像 "时间" 与 "空间"：典型的 IVP 里自变量常是时间，初值会决定未来演化的全部细节；即便是很简单的 BVP，所需的信息也分散在整个区间上，而且可能存在不止一种满足边界条件的解.

**#2 Dirichlet、Neumann、Robin 边界条件**

一些常见边界条件有专门的名字.

> **Definition:** Dirichlet, Neumann, and Robin conditions
> Let $g_i$ be a boundary condition in the TPBVP definition above, and let $\alpha,\,\beta$ be constants.
>
> Dirichlet condition: $g_i(u,u') = u-\alpha$.
>
> Neumann condition: $g_i(u,u') = u'-\alpha$.
>
> Robin condition: $g_i(u,u') = u+\beta u'-\alpha$.
>
> When $\alpha=0$ in the above, the condition is said to be homogeneous.

> **Example:**
> An ideal pendulum of length $L$ satisfies the ODE $\theta'' + \frac{g}{L}\sin\theta=0$, where $\theta(t)$ is the angle of the pendulum's rod from straight downward, and $g$ is gravitational acceleration.
>
> If we pull the pendulum bob 1 radian and release it from rest, then we have an IVP with the initial condition $\theta(0)=1$, $\theta'(0)=0$. Everything about the future trajectory of the pendulum is completely determined by that condition. But if instead we want to know how far to pull up the pendulum bob initially so that it is in the downward position 2 seconds later, then we have the Neumann boundary condition $\theta'(0)=0$ and the Dirichlet boundary condition $\theta(2)=0$.
>
> Clearly, one solution is $\theta(t)=0$, and the pendulum never moves! But there is also an initial deflection such that $\theta(2)=0$ momentarily as the pendulum finishes its first downward swing. There could be still more solutions in which the pendulum completes one or more half-periods before passing again through the downward position at just the right moment.

虽然在两点边值问题里，自变量也可以是时间 (如前面的理想摆 Example)，但它常常代表空间. 在空间变量里，我们通常不能像 IVP 那样期待 "从左到右" 的单向信息流.

**#3 一个非线性两点边值问题的例子**

> **Example:**
> A micromechanical electrically driven actuator consists of two flat disk-shaped surfaces in parallel, one at $z=0$ and the other at $z=1$. The surface at $z=0$ is a rigid metal plate. The surface at $z=1$ is an elastic membrane fixed only at its boundary. When the surfaces are given different electric potentials, the membrane deflects in response to the induced electric field, and the field is also a position of the deflection. Assuming circular symmetry, one may derive the ordinary differential equation [PD06]
> $$
> \frac{d^2 w}{dr^2} + \frac{1}{r}\frac{dw}{dr} = \frac{\lambda}{w^2},
> $$
> where $w(r)$ is the vertical position of the membrane at radius $r$, and $\lambda$ is proportional to the applied electric potential. We will use $0\le r\le 1$. There are also the supplemental physical conditions
> $$
> w'(0)=0,\qquad w(1)=1,
> $$
> derived from the circular symmetry and fixing the edge of the membrane, respectively. This is a nonlinear boundary-value problem. The solution should respect $0<w(r)\le 1$ in order to be physically meaningful.

**#4 数值求解**

我们可以像处理 IVP 那样，把 TPBVP 改写为一阶系统来求解.

> **Demo:** Solving the MEMS TPBVP with `solve_bvp`
> As a system, the MEMS problem in the previous Example uses $y_1=w$ and $y_2=w'$ to obtain
> $$
> y_1' = y_2,\qquad y_2' = \frac{\lambda}{y_1^2}-\frac{y_2}{r}.
> $$
> The boundary conditions are $y_2(0)=0$ and $y_1(1)=1$. Because the ODE includes division by $r$, we truncate the domain slightly away from 0.
>
> We also need an initial estimate for the solution, which plays a role similar to initialization in Newton's method. Here we try a constant value for each component.
>
> ```Python
> import numpy as np
> import matplotlib.pyplot as plt
> from scipy.integrate import solve_bvp
>
> lam = 0.6
>
> def fun(r, y):
>     w = y[0]
>     wp = y[1]
>     return np.vstack((wp, lam / (w**2) - wp / r))
>
> def bc(ya, yb):
>     return np.array([ya[1], yb[0] - 1.0])
>
> r0 = np.finfo(float).eps
> r = np.linspace(r0, 1.0, 200)
> y_init = np.vstack((np.ones_like(r), np.zeros_like(r)))
>
> sol = solve_bvp(fun, bc, r, y_init, max_nodes=10000)
> print("success", sol.success, "|", sol.message)
> print("min w(r)", sol.y[0].min())
>
> rr = np.linspace(r0, 1.0, 400)
> yy = sol.sol(rr)
> plt.plot(rr, yy[0], label="w")
> plt.plot(rr, yy[1], label="w'")
> plt.xlabel("r")
> plt.ylabel("solution")
> plt.title(f"MEMS BVP solution (lambda={lam})")
> plt.grid(True, alpha=0.3)
> plt.legend()
> plt.show()
> ```
>
> To visual accuracy, the boundary conditions are enforced.

从理论上刻画 TPBVP 的条件性并不容易. 有一些数值工具被称为 **sensitivity analysis**，但细节太长，这里暂不展开.
