# 11-3-绝对稳定性 (Absolute stability)

这是一份数值计算学习笔记，参考了 Tobin A. Driscoll and Richard J. Braun 的教材 [*Fundamentals of Numerical Computation* (2023)](https://tobydriscoll.net/fnc-julia/home.html).

> 这份笔记主要是翻译了原文内容，并删改或重新表述部分内容，希望能进一步减少初学者的学习障碍.

**#1 绝对稳定性的动机**

在 **11-2-线法** 里，我们把热方程做了空间半离散化，并对线性常系数系统

$$
\mathbf{u}'(t)=\mathbf{A}\mathbf{u}(t)
$$

尝试了多种时间推进方法. 这些方法在 **6-8-多步法的零稳定性** 的意义下都满足零稳定性：当时间步长 $\tau\to 0$ 且时间区间固定时，它们不会因为多步递推结构而自发放大误差. 但在固定 $\tau$ 的实验中，我们却观察到了随步数 $n\to\infty$ 的指数增长.

如果 $\mathbf{A}$ 可对角化：$\mathbf{A}=\mathbf{V}\mathbf{D}\mathbf{V}^{-1}$，那么

$$
\mathbf{u}'=(\mathbf{V}\mathbf{D}\mathbf{V}^{-1})\mathbf{u}
\quad\Longrightarrow\quad
\bigl(\mathbf{V}^{-1}\mathbf{u}\bigr)'=\mathbf{D}\bigl(\mathbf{V}^{-1}\mathbf{u}\bigr).
$$

令 $\mathbf{y}(t)=\mathbf{V}^{-1}\mathbf{u}(t)$，则 $\mathbf{y}'=\mathbf{D}\mathbf{y}$. 由于 $\mathbf{D}$ 是对角矩阵，各分量完全解耦：每一行都满足一个标量方程 $y_j'=\lambda_j y_j$，其中 $\lambda_j$ 是 $\mathbf{A}$ 的特征值.

因此，我们可以把注意力集中到标量测试问题

$$
y'=\lambda y,\qquad y(0)=1,
$$

其中 $\lambda$ 允许是复数 (这里的 $i$ 表示虚数单位). 写成 $\lambda=\alpha+i\beta$ 后，精确解的模为 $|e^{(\alpha+i\beta)t}|=e^{\alpha t}$.

> **Observation:**
> Solutions of $y'=\lambda y$ are bounded as $t\to\infty$ if and only if $\operatorname{Re}\lambda\le 0$.

接下来我们关心：数值 IVP 求解器在这个测试问题上的对应结论是什么.

**#2 绝对稳定与稳定区域**

> **Definition:** Absolute stability
> Let $\lambda$ be a complex number, and let $y_0,y_1,\dots,y_n$ be the numerical solution at times $0,\tau,2\tau,\dots,n\tau$ of $y'=\lambda y$, $y(0)=1$ using a Runge-Kutta or multistep method with fixed stepsize $\tau$.
>
> The method is said to be absolutely stable at $\zeta=\tau\lambda$ if $|y_n|$ is bounded above as $n\to\infty$.

绝对稳定性只依赖乘积 $\zeta=\tau\lambda$，而不依赖 $\tau$ 与 $\lambda$ 的单独取值. 从量纲上看，$\lambda$ 具有 "时间的倒数" 的量纲，因此 $\zeta$ 是无量纲量.

> **Definition:** Stability region
> The stability region of an IVP solver is the set of all $\zeta\in\mathbb{C}$ for which the method is absolutely stable.

**#3 典型稳定区域的例子**

> **Example:**
> Forward Euler discretizes $y'=\lambda y$ as
> $$
> y_{k+1}=y_k+\tau(\lambda y_k)=(1+\zeta)y_k.
> $$
> Hence $y_k=(1+\zeta)^k$, and $|y_k|$ remains bounded as $k\to\infty$ if and only if $|1+\zeta|\le 1$. Geometrically, this is the closed disk of radius 1 centered at $-1$ in the complex $\zeta$-plane.

> **Example:**
> Backward Euler discretizes $y'=\lambda y$ as
> $$
> y_{k+1}=y_k+\tau(\lambda y_{k+1})\quad\Longrightarrow\quad y_{k+1}=\frac{1}{1-\zeta}y_k.
> $$
> Hence $y_k=(1-\zeta)^{-k}$, and absolute stability requires $|1-\zeta|^{-1}\le 1$, i.e., $|\zeta-1|\ge 1$. This is the region outside the open disk of radius 1 centered at $1$ in the complex plane.

> **Example:**
> The improved Euler method (a 2nd-order Runge-Kutta method) discretizes $y'=\lambda y$ as
> $$
> y_{k+1}=y_k+\zeta\Bigl(y_k+\frac{1}{2}\zeta y_k\Bigr)=(1+\zeta+\tfrac{1}{2}\zeta^2)y_k.
> $$
> The stability region consists of all $\zeta$ such that $|1+\zeta+\tfrac{1}{2}\zeta^2|\le 1$. Boundary points satisfy $1-e^{i\theta}+\zeta+\tfrac{1}{2}\zeta^2=0$ for some real $\theta$.

不同方法的稳定区域形状差异很大. 经验上，隐式方法 (例如 Adams-Moulton、BDF、隐式 Runge-Kutta) 的稳定区域通常更大；代价是每一步需要解线性系统或非线性方程组. 但更大的稳定区域意味着它们可以在保持稳定的同时使用远大于显式方法的时间步长.

下面这个例子说明稳定区域如何转化为对时间步长的约束.

> **Example:**
> Suppose $\lambda=-4$ and forward Euler is applied. Since $\tau>0$, we have $\zeta=-4\tau$ on the negative real axis. The part of that axis inside Euler's stability region is the interval $[-2,0]$, hence we require $\tau\le 1/2$.
>
> By contrast, the stability region of backward Euler includes the entire negative real axis, so it is unconditionally stable for this $\lambda$ (stable for any $\tau>0$).
>
> Now suppose $\lambda=i$, so $\zeta=i\tau$ is on the imaginary axis. Aside from the origin, no point of the imaginary axis lies in Euler's stability region, so Euler is unconditionally unstable in this circumstance. For backward Euler, any value of $\tau$ works because the entire imaginary axis is contained in its stability region.

需要注意：这些结论并不与我们对 Euler 方法的零稳定性与收敛性结论矛盾. 之前的收敛性讨论基于 $\tau\to 0$ 且 $t$ 位于有限区间 $[a,b]$；而绝对稳定性强调的是在固定 $\tau$ 下把步数推进到无穷远的行为 ($t\to\infty$). 两个极限里，虽然 $n$ 都会趋于无穷大，但性质并不相同.

此外，在实际的自适应时间步长方法中，算法会自动选择步长以避免绝对不稳定 (否则误差会指数增长). 在 **11-2-线法** 里，我们已经看到：显式自适应方法会被迫使用极小步长，而基于隐式思想的刚性求解器可以用少得多的步数完成同样的演化.

**#4 热方程的半离散化：步长约束从何而来**

现在回到热方程在周期边界条件下的半离散系统

$$
\mathbf{u}'=\mathbf{D}_{xx}\mathbf{u}.
$$

> **Demo:** Eigenvalues and absolute stability for the periodic heat equation
> We compute the eigenvalues of $\mathbf{D}_{xx}$ and compare $\zeta=\tau\lambda$ against Euler's stability disk.
>
> ```Python
> import numpy as np
> import matplotlib.pyplot as plt
>
> m = 40
> x, Dx, Dxx = diffper(m, (0.0, 1.0))
> lam = np.linalg.eigvals(Dxx.toarray())
>
> plt.scatter(lam.real, lam.imag, s=20)
> plt.axhline(0.0, color="k", lw=0.8, alpha=0.3)
> plt.axvline(0.0, color="k", lw=0.8, alpha=0.3)
> plt.gca().set_aspect("equal", adjustable="box")
> plt.title("Eigenvalues of Dxx")
> plt.xlabel("Re λ")
> plt.ylabel("Im λ")
> plt.show()
>
> # Euler stability region: |ζ+1|<=1.
> theta = np.linspace(0.0, 2.0 * np.pi, 600)
> disk = -1.0 + np.exp(1j * theta)
> plt.plot(disk.real, disk.imag, label="|ζ+1|=1")
>
> lam_min = lam.real.min()  # most negative eigenvalue
> tau_max = -2.0 / lam_min  # largest τ that keeps all τ*λ in [-2,0]
> zeta = tau_max * lam
> plt.scatter(zeta.real, zeta.imag, s=20, label="ζ = τλ")
>
> plt.axhline(0.0, color="k", lw=0.8, alpha=0.3)
> plt.axvline(0.0, color="k", lw=0.8, alpha=0.3)
> plt.gca().set_aspect("equal", adjustable="box")
> plt.title(f"Euler stability region and ζ values (τ={tau_max:.3e})")
> plt.xlabel("Re ζ")
> plt.ylabel("Im ζ")
> plt.legend()
> plt.show()
> print("tau_max =", tau_max)
> ```
>
> For backward Euler, the stability region contains the entire negative real axis, so any $\tau>0$ is stable in this eigenvalue configuration.

周期热方程的 $\mathbf{D}_{xx}$ 还可以显式写出特征值. 当 $x\in[0,1)$、$h=1/m$ 时，特征值为

$$
\lambda_j=-4m^2\sin^2\Bigl(\frac{j\pi}{m}\Bigr),\qquad j=0,\dots,m-1.
$$

因此它们落在区间 $[-4m^2,0]$ 上，并且全是非正实数. 对前向 Euler，稳定性要求所有 $\zeta=\tau\lambda_j$ 都位于 $[-2,0]$，所以必须满足

$$
\tau\,(-4m^2)\ge -2
\quad\Longrightarrow\quad
\tau\le \frac{1}{2m^2}=O(m^{-2}).
$$

而对后向 Euler，不存在这样的步长限制；我们称它对该问题是无条件稳定 (**unconditionally stable**) 的.

当 $h\to 0$ 时，会同时发生三件事：

1. 空间离散更准确，误差为 $O(h^2)$.
2. 矩阵规模随网格加密增长，规模为 $O(h^{-1})$.
3. 若使用显式时间推进方法，为满足绝对稳定性需要 $O(h^{-2})$ 级别的时间步数.

第 3 条在 $h\to 0$ 时会迅速变得难以承受，因此扩散问题往往更偏好隐式方法. 即使某个 IVP 求解器在 $\tau\to 0$ 的意义下是收敛的，只要 $\tau$ 还没小到满足绝对稳定性，数值解就可能呈现出指数级别的 "胡乱爆炸".

